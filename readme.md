本程序用于解析UDP报文
## 文件结构
```java
├── UdpAgentApplication.java # 主程序，从这里开始看
├── config # 配置文件，配置线程池和kafka，ChannelConfig没使用
│   ├── ChannelConfig.java
│   ├── ExecutorConfig.java 
│   └── KafkaConfig.java
├── parser # 解析类，目前只实现对波长模式返回报文解析
│   ├── ResponseParser.java
│   └── WavelengthModeResponseParser.java
├── service # 服务类
│   ├── FiberOpticTask.java # 解析报文发送kafka类
│   ├── UDPClientService.java # udp客户端
│   └── UDPServerService.java # udp 服务端
└── util # 工具类
    ├── ByteUtils.java
    ├── CommandConstants.java
    └── FiberOpticUtils.java

```


## 协议解析
### 波长模式
![image-20240602上午95932081](https://huaka1-tuchuang.oss-cn-hangzhou.aliyuncs.com/202406020959107.png)

实例：
wireshark抓包完整报文：
```java
3002000003d6001d76d2011d6ace021d5ec1030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d
```

解析：
```
30 02 00 00 03 d6 #响应头
00 1d76d2 # 1d76d2为通道1编号1数据
01 1d6ace # 1d6ace为通道1编号2数据
02 1d5ec1 # 1d5ec1为通道1编号3数据
# 后面为编号4到编号30的数据，解析同上
030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000
043d # 通道1结尾，管壳温度

# 后面为通道2-通道8的数据，解析同上
000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d
000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d000000000100000002000000030000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d000000043d
```

十六进制转换网站：[https://tool.lu/hexconvert/](https://tool.lu/hexconvert/)

## 配置
### 线程池配置
<img src="https://huaka1-tuchuang.oss-cn-hangzhou.aliyuncs.com/202406020959706.png" alt="image-20240602上午95945689" style="zoom: 33%;" />
线程池工作原理：

1. 来了一个任务，如果线程没达到核心线程数（corePoolSize），则立马创建线程执行任务。
2. 如果到了核心线程数，都在执行，但任务队列（workQueue）没满，放到任务队列等待。
3. 如果任务队列满了，则创建新线程执行，但不能超过最大线程池数（maxPoolSize）。
4. 如果任务队列满了，线程也达到了最大线程数，则执行拒绝策略。

项目配置：

核心线程数2，最大线程数2，队列0

使用1个线程会出现部分丢包，设置线程数=2即可，如果有包未执行即会出现线程池拒绝策略，日志中有error日志（初始报错正常，因为线程还没创建)。
